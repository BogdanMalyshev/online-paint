(this["webpackJsonpreal-time-paint"]=this["webpackJsonpreal-time-paint"]||[]).push([[0],{23:function(t,e,n){},24:function(t,e,n){},31:function(t,e,n){},32:function(t,e,n){},33:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n.n(a),o=n(11),i=n.n(o),c=(n(23),n(8)),r=(n(24),n(2)),u="SET_TOOL",h="SET_CANVAS",l="SET_UNDO_LIST",f="SET_REDO_LIST";function v(t){return{type:u,tool:t}}function d(t){return{type:f,list:t}}function b(t){return{type:l,list:t}}var m=n(3),j=n(4),O=n(6),w=n(5),p=function(){function t(e){Object(m.a)(this,t),this.canvas=e,this.ctx=e.getContext("2d"),this.destroyEvents()}return Object(j.a)(t,[{key:"fillColor",set:function(t){this.ctx.fillStyle=t}},{key:"strokeColor",set:function(t){this.ctx.strokeStyle=t}},{key:"lineWidth",set:function(t){this.ctx.lineWidth=t}},{key:"destroyEvents",value:function(){this.canvas.onmouseup=null,this.canvas.onmousedown=null,this.canvas.onmousemove=null}}]),t}(),g=function(t){Object(O.a)(n,t);var e=Object(w.a)(n);function n(t){var a;return Object(m.a)(this,n),(a=e.call(this,t)).listen(),a.mouseDown=!1,a}return Object(j.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(){this.mouseDown=!1}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),this.ctx.moveTo(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop)}},{key:"mouseMoveHandler",value:function(t){this.mouseDown&&this.draw(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop)}},{key:"draw",value:function(t,e){this.ctx.lineTo(t,e),this.ctx.stroke()}}]),n}(p),x=function(t){Object(O.a)(n,t);var e=Object(w.a)(n);function n(t){var a;return Object(m.a)(this,n),(a=e.call(this,t)).listen(),a}return Object(j.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.ctx.beginPath(),this.startY=t.pageY-t.target.offsetTop,this.startX=t.pageX-t.target.offsetLeft,this.saved=this.canvas.toDataURL()}},{key:"mouseMoveHandler",value:function(t){if(this.mouseDown){var e=t.pageY-t.target.offsetTop,n=t.pageX-t.target.offsetLeft-this.startX,a=e-this.startY;this.draw(this.startX,this.startY,n,a)}}},{key:"draw",value:function(t,e,n,a){var s=this,o=new Image;o.src=this.saved,o.onload=function(){s.ctx.clearRect(0,0,s.canvas.width,s.canvas.height),s.ctx.drawImage(o,0,0,s.canvas.width,s.canvas.height),s.ctx.beginPath(),s.ctx.rect(t,e,n,a),s.ctx.fill(),s.ctx.stroke()}}}]),n}(p),k=n(9),y=n.n(k),D=n(13),_=function(t){Object(O.a)(n,t);var e=Object(w.a)(n);function n(t){var a;return Object(m.a)(this,n),(a=e.call(this,t)).listen(),a}return Object(j.a)(n,[{key:"listen",value:function(){this.canvas.onmousemove=this.mouseMoveHandler.bind(this),this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this)}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0;var e=this.canvas.toDataURL();this.ctx.beginPath(),this.startX=t.pageX-t.target.offsetLeft,this.startY=t.pageY-t.target.offsetTop,this.saved=e}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseMoveHandler",value:function(t){if(this.mouseDown){var e=t.pageX-t.target.offsetLeft,n=t.pageY-t.target.offsetTop,a=e-this.startX,s=n-this.startY,o=Math.sqrt(Math.pow(a,2)+Math.pow(s,2));this.draw(this.startX,this.startY,o)}}},{key:"draw",value:function(t,e,n){var a=new Image;a.src=this.saved,a.onload=Object(D.a)(y.a.mark((function s(){return y.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(a,0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.arc(t,e,n,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke();case 6:case"end":return s.stop()}}),s,this)}))).bind(this)}}]),n}(p),L=function(t){Object(O.a)(n,t);var e=Object(w.a)(n);function n(t){var a;return Object(m.a)(this,n),(a=e.call(this,t)).listen(),a.name="Line",a}return Object(j.a)(n,[{key:"listen",value:function(){this.canvas.onmousedown=this.mouseDownHandler.bind(this),this.canvas.onmouseup=this.mouseUpHandler.bind(this),this.canvas.onmousemove=this.mouseMoveHandler.bind(this)}},{key:"mouseDownHandler",value:function(t){this.mouseDown=!0,this.currentX=t.pageX-t.target.offsetLeft,this.currentY=t.pageY-t.target.offsetTop,this.ctx.beginPath(),this.ctx.moveTo(this.currentX,this.currentY),this.saved=this.canvas.toDataURL()}},{key:"mouseUpHandler",value:function(t){this.mouseDown=!1}},{key:"mouseMoveHandler",value:function(t){this.mouseDown&&this.draw(t.pageX-t.target.offsetLeft,t.pageY-t.target.offsetTop)}},{key:"draw",value:function(t,e){var n=new Image;n.src=this.saved,n.onload=Object(D.a)(y.a.mark((function a(){return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(n,0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.moveTo(this.currentX,this.currentY),this.ctx.lineTo(t,e),this.ctx.stroke();case 6:case"end":return a.stop()}}),a,this)}))).bind(this)}}]),n}(p),H=function(t){Object(O.a)(n,t);var e=Object(w.a)(n);function n(t){var a;return Object(m.a)(this,n),(a=e.call(this,t)).canvasListen(),a.prevColor=a.ctx.strokeStyle,a}return Object(j.a)(n,[{key:"canvasListen",value:function(){var t=this;this.canvas.onmousedown=function(e){t.ctx.strokeStyle="#ffffff",t.mouseDownHandler(e)},this.canvas.onmouseup=function(e){t.ctx.strokeStyle=t.prevColor,t.mouseUpHandler(e)}}},{key:"draw",value:function(t,e){this.ctx.lineTo(t,e),this.ctx.stroke()}}]),n}(g),C=n(1);var T=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.canvas})),n=Object(r.c)((function(t){return t.tool})),a=Object(r.c)((function(t){return t.undoList})),s=Object(r.c)((function(t){return t.redoList}));function o(t,n){var a=new Image;a.src=t,a.onload=function(){n.clearRect(0,0,e.width,e.height),n.drawImage(a,0,0,e.width,e.height)}}return Object(C.jsxs)("div",{className:"toolbar",children:[Object(C.jsx)("button",{className:"toolbar__btn brush",onClick:function(){return t(v(new g(e)))}}),Object(C.jsx)("button",{className:"toolbar__btn rect",onClick:function(){return t(v(new x(e)))}}),Object(C.jsx)("button",{className:"toolbar__btn circle",onClick:function(){return t(v(new _(e)))}}),Object(C.jsx)("button",{className:"toolbar__btn eraser",onClick:function(){return t(v(new H(e)))}}),Object(C.jsx)("button",{className:"toolbar__btn line",onClick:function(){return t(v(new L(e)))}}),Object(C.jsx)("input",{type:"color",onChange:function(t){n.fillColor=t.target.value},className:"change-color"}),Object(C.jsx)("button",{className:"toolbar__btn undo",onClick:function(){var n=e.getContext("2d"),i=Object(c.a)(a);if(i.length>0){var r=i.pop();t(b(i));var u=[].concat(Object(c.a)(s),[e.toDataURL()]);t(d(u)),o(r,n)}else n.clearRect(0,0,e.width,e.heigth)}}),Object(C.jsx)("button",{className:"toolbar__btn redo",onClick:function(){var n=e.getContext("2d"),i=Object(c.a)(s);if(i.length>0){var r=i.pop();t(d(i)),t(b([].concat(Object(c.a)(a),[e.toDataURL()]))),o(r,n)}}}),Object(C.jsx)("button",{className:"toolbar__btn save",onClick:function(){var t=e.toDataURL(),n=document.createElement("a");n.href=t,n.download="image.jpg",document.body.appendChild(n),n.click(),document.body.removeChild(n)}})]})},E=n(18);n(31);var X=function(){var t=Object(r.c)((function(t){return t.tool})),e=Object(a.useState)("1"),n=Object(E.a)(e,2),s=n[0],o=n[1],i=Object(a.useRef)();return Object(a.useEffect)((function(){console.dir(i.current)}),[s]),Object(C.jsxs)("div",{className:"setting-bar",children:[Object(C.jsx)("label",{htmlFor:"line-width",children:"\u0422\u043e\u043b\u0449\u0438\u043d\u0430 \u043b\u0438\u043d\u0438\u0438"}),Object(C.jsx)("input",{ref:i,onChange:function(e){var n=e.target.value;switch(n){case n>50:o("50"),t.lineWidth=50;break;case n<1:o("1"),t.lineWidth=1;break;default:o(n),t.lineWidth=n}},id:"line-width",type:"number",min:1,max:50,value:s}),Object(C.jsx)("label",{htmlFor:"stroke-color",children:"\u0426\u0432\u0435\u0442 \u043e\u0431\u0432\u043e\u0434\u043a\u0438"}),Object(C.jsx)("input",{onChange:function(e){return t.strokeColor=e.target.value},id:"stroke-color",type:"color"})]})};n(32);var S=function(){var t=Object(a.useRef)(),e=Object(r.b)(),n=Object(r.c)((function(t){return t.undoList}));return Object(a.useEffect)((function(){var n;e((n=t.current,{type:h,canvas:n})),e(v(new g(t.current)))}),[]),Object(C.jsx)("div",{className:"canvas",children:Object(C.jsx)("canvas",{onMouseDown:function(){var a=Object(c.a)(n);a.push(t.current.toDataURL()),e(b(a)),e(d([]))},ref:t,width:900,height:600})})};var N=function(){return Object(C.jsxs)("div",{className:"app",children:[Object(C.jsx)(T,{}),Object(C.jsx)(X,{}),Object(C.jsx)(S,{})]})},U=n(17),R=n(7),Y={tool:null,canvas:null,redoList:[],undoList:[]},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case u:return Object(R.a)(Object(R.a)({},t),{},{tool:e.tool});case h:return Object(R.a)(Object(R.a)({},t),{},{canvas:e.canvas});case l:return Object(R.a)(Object(R.a)({},t),{},{undoList:e.list});case f:return Object(R.a)(Object(R.a)({},t),{},{redoList:e.list});default:return t}};var I=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?Object(U.a)(M,window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__()):Object(U.a)(M);i.a.render(Object(C.jsx)(s.a.StrictMode,{children:Object(C.jsx)(r.a,{store:I,children:Object(C.jsx)(N,{})})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.2c57e651.chunk.js.map